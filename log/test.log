  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.0ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.0ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.3ms)[0m  SELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  SELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  SELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  SELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  SELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35mSQL (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.3ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` IS NULL) LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.4ms)[0m  SHOW TABLES
  [1m[36mProduct Load (0.2ms)[0m  [1mSELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'Programming Ruby') LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35mSQL (0.0ms)[0m  BEGIN
  [1m[36mProduct Load (0.2ms)[0m  [1mSELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1[0m
  [1m[35mSQL (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'Programming Ruby') LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35mSQL (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.3ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'Book') LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.0ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mAREL (0.4ms)[0m  DELETE FROM `line_items`
  [1m[36mAREL (0.2ms)[0m  [1mDELETE FROM `orders`[0m
  [1m[35mSQL (0.4ms)[0m  SHOW TABLES
  [1m[36mProduct Load (0.3ms)[0m  [1mSELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1[0m


Started GET "/" for 127.0.0.1 at 2011-07-23 13:05:38 +0800
  Processing by StoreController#index as HTML
  [1m[35mProduct Load (0.3ms)[0m  SELECT `products`.* FROM `products` ORDER BY title
  [1m[36mSQL (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.9ms)[0m  describe `carts`
  [1m[36mAREL (0.2ms)[0m  [1mINSERT INTO `carts` (`created_at`, `updated_at`) VALUES ('2011-07-23 05:05:38', '2011-07-23 05:05:38')[0m
  [1m[35mSQL (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mSELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 1)[0m
Rendered carts/_cart.html.erb (0.5ms)
Rendered store/index.html.erb within layouts/application (105.7ms)
Completed 200 OK in 121ms (Views: 108.6ms | ActiveRecord: 179.8ms)


Started POST "/line_items" for 127.0.0.1 at 2011-07-23 13:05:38 +0800
  Processing by LineItemsController#create as JS
  Parameters: {"product_id"=>"207281424"}
  [1m[35mCart Load (0.3ms)[0m  SELECT `carts`.* FROM `carts` WHERE `carts`.`id` = 1 LIMIT 1
  [1m[36mProduct Load (0.2ms)[0m  [1mSELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1[0m
  [1m[35mLineItem Load (0.2ms)[0m  SELECT `line_items`.* FROM `line_items` WHERE `line_items`.`product_id` = 207281424 AND (`line_items`.cart_id = 1) LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.4ms)[0m  describe `line_items`
  [1m[36mAREL (0.2ms)[0m  [1mINSERT INTO `line_items` (`product_id`, `cart_id`, `created_at`, `updated_at`, `quantity`, `order_id`) VALUES (207281424, 1, '2011-07-23 05:05:38', '2011-07-23 05:05:38', 1, NULL)[0m
  [1m[35mSQL (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mSELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 1)[0m
  [1m[35mLineItem Load (0.2ms)[0m  SELECT `line_items`.* FROM `line_items` WHERE (`line_items`.cart_id = 1)
  [1m[36mProduct Load (0.3ms)[0m  [1mSELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1[0m
Rendered line_items/_line_item.html.erb (4.9ms)
Rendered carts/_cart.html.erb (9.1ms)
  [1m[35mSQL (0.2ms)[0m  SELECT SUM(`line_items`.`quantity`) AS sum_id FROM `line_items` WHERE (`line_items`.cart_id = 1)
Rendered line_items/create.js.rjs (11.3ms)
Completed 200 OK in 41ms (Views: 25.1ms | ActiveRecord: 3.3ms)
  [1m[36mCart Load (0.2ms)[0m  [1mSELECT `carts`.* FROM `carts` WHERE `carts`.`id` = 1 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  SELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 1)
  [1m[36mLineItem Load (0.2ms)[0m  [1mSELECT `line_items`.* FROM `line_items` WHERE (`line_items`.cart_id = 1)[0m
  [1m[35mProduct Load (0.2ms)[0m  SELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1


Started GET "/orders/new" for 127.0.0.1 at 2011-07-23 13:05:38 +0800
  Processing by OrdersController#new as HTML
  [1m[36mCart Load (0.2ms)[0m  [1mSELECT `carts`.* FROM `carts` WHERE `carts`.`id` = 1 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  SELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 1)
Rendered orders/_form.html.erb (7.6ms)
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 1)[0m
  [1m[35mCACHE (0.0ms)[0m  SELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 1)
  [1m[36mLineItem Load (0.3ms)[0m  [1mSELECT `line_items`.* FROM `line_items` WHERE (`line_items`.cart_id = 1)[0m
  [1m[35mProduct Load (0.2ms)[0m  SELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1
Rendered line_items/_line_item.html.erb (1.7ms)
Rendered carts/_cart.html.erb (4.4ms)
Rendered orders/new.html.erb within layouts/application (15.4ms)
Completed 200 OK in 21ms (Views: 16.6ms | ActiveRecord: 1.7ms)


Started POST "/orders" for 127.0.0.1 at 2011-07-23 13:05:38 +0800
  Processing by OrdersController#create as HTML
  Parameters: {"order"=>{"name"=>"Dave Thomas", "address"=>"123 The Street", "email"=>"cui.shujun@live.cn", "pay_type"=>"Check"}}
  [1m[36mCart Load (0.3ms)[0m  [1mSELECT `carts`.* FROM `carts` WHERE `carts`.`id` = 1 LIMIT 1[0m
  [1m[35mLineItem Load (0.2ms)[0m  SELECT `line_items`.* FROM `line_items` WHERE (`line_items`.cart_id = 1)
  [1m[36mSQL (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mSQL (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.3ms)[0m  describe `orders`
  [1m[36mAREL (0.1ms)[0m  [1mINSERT INTO `orders` (`name`, `address`, `email`, `pay_type`, `created_at`, `updated_at`) VALUES ('Dave Thomas', '123 The Street', 'cui.shujun@live.cn', 'Check', '2011-07-23 05:05:38', '2011-07-23 05:05:38')[0m
  [1m[35mAREL (0.2ms)[0m  UPDATE `line_items` SET `cart_id` = NULL, `order_id` = 1, `updated_at` = '2011-07-23 05:05:38' WHERE `line_items`.`id` = 1
  [1m[36mSQL (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCart Load (0.1ms)[0m  SELECT `carts`.* FROM `carts` WHERE `carts`.`id` = 1 LIMIT 1
  [1m[36mSQL (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mLineItem Load (0.1ms)[0m  SELECT `line_items`.* FROM `line_items` WHERE (`line_items`.cart_id = 1)
  [1m[36mAREL (0.1ms)[0m  [1mDELETE FROM `carts` WHERE `carts`.`id` = 1[0m
  [1m[35mSQL (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mProduct Load (0.3ms)[0m  [1mSELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1[0m
Rendered line_items/_line_item.text.erb (1.3ms)
Rendered notifier/order_received.text.erb (2.4ms)

Sent mail to cui.shujun@live.cn (26ms)
Date: Sat, 23 Jul 2011 13:05:38 +0800
From: shujun.cui@cubead.com
To: cui.shujun@live.cn
Message-ID: <4e2a56a24d24f_96380443b3c483de@localhost.mail>
Subject: Pragmatic Store Order Confirmation
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

Dear Dave Thomas

Thank you for your recent order from The Pragmatic Store.

You ordered the following items:

 1 x Programming Ruby


We'll send you a separate e-mail when your order ships.
Redirected to http://www.example.com/cn
Completed 302 Found in 110ms


Started GET "/cn" for 127.0.0.1 at 2011-07-23 13:05:38 +0800
  Processing by StoreController#index as HTML
  Parameters: {"locale"=>"cn"}
  [1m[35mProduct Load (0.3ms)[0m  SELECT `products`.* FROM `products` ORDER BY title
  [1m[36mSQL (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mAREL (0.2ms)[0m  INSERT INTO `carts` (`created_at`, `updated_at`) VALUES ('2011-07-23 05:05:38', '2011-07-23 05:05:38')
  [1m[36mSQL (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  SELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 2)
Rendered carts/_cart.html.erb (0.0ms)
Rendered store/index.html.erb within layouts/application (3.9ms)
Completed 200 OK in 7ms (Views: 4.1ms | ActiveRecord: 4.0ms)
  [1m[36mCart Load (0.2ms)[0m  [1mSELECT `carts`.* FROM `carts` WHERE `carts`.`id` = 2 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  SELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 2)
  [1m[36mOrder Load (0.2ms)[0m  [1mSELECT `orders`.* FROM `orders`[0m
  [1m[35mSQL (0.2ms)[0m  SELECT COUNT(*) FROM `line_items` WHERE (`line_items`.order_id = 1)
  [1m[36mLineItem Load (0.2ms)[0m  [1mSELECT `line_items`.* FROM `line_items` WHERE (`line_items`.order_id = 1)[0m
  [1m[35mProduct Load (0.2ms)[0m  SELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mROLLBACK[0m
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.3ms)[0m  SELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  SELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  SELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  SELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  SELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35mSQL (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.3ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` IS NULL) LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.3ms)[0m  SHOW TABLES
  [1m[36mProduct Load (0.2ms)[0m  [1mSELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'Programming Ruby') LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35mSQL (0.1ms)[0m  BEGIN
  [1m[36mProduct Load (0.2ms)[0m  [1mSELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1[0m
  [1m[35mSQL (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'Programming Ruby') LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35mSQL (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.2ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'Book') LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mAREL (0.2ms)[0m  DELETE FROM `line_items`
  [1m[36mAREL (0.2ms)[0m  [1mDELETE FROM `orders`[0m
  [1m[35mSQL (0.3ms)[0m  SHOW TABLES
  [1m[36mProduct Load (0.2ms)[0m  [1mSELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1[0m


Started GET "/" for 127.0.0.1 at 2011-07-23 13:07:11 +0800
  Processing by StoreController#index as HTML
  [1m[35mProduct Load (0.3ms)[0m  SELECT `products`.* FROM `products` ORDER BY title
  [1m[36mSQL (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.9ms)[0m  describe `carts`
  [1m[36mAREL (0.2ms)[0m  [1mINSERT INTO `carts` (`created_at`, `updated_at`) VALUES ('2011-07-23 05:07:11', '2011-07-23 05:07:11')[0m
  [1m[35mSQL (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mSELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 1)[0m
Rendered carts/_cart.html.erb (0.6ms)
Rendered store/index.html.erb within layouts/application (103.7ms)
Completed 200 OK in 118ms (Views: 106.0ms | ActiveRecord: 3.9ms)


Started POST "/line_items" for 127.0.0.1 at 2011-07-23 13:07:11 +0800
  Processing by LineItemsController#create as JS
  Parameters: {"product_id"=>"207281424"}
  [1m[35mCart Load (0.3ms)[0m  SELECT `carts`.* FROM `carts` WHERE `carts`.`id` = 1 LIMIT 1
  [1m[36mProduct Load (0.2ms)[0m  [1mSELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1[0m
  [1m[35mLineItem Load (0.2ms)[0m  SELECT `line_items`.* FROM `line_items` WHERE `line_items`.`product_id` = 207281424 AND (`line_items`.cart_id = 1) LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.4ms)[0m  describe `line_items`
  [1m[36mAREL (0.2ms)[0m  [1mINSERT INTO `line_items` (`product_id`, `cart_id`, `created_at`, `updated_at`, `quantity`, `order_id`) VALUES (207281424, 1, '2011-07-23 05:07:11', '2011-07-23 05:07:11', 1, NULL)[0m
  [1m[35mSQL (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mSELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 1)[0m
  [1m[35mLineItem Load (0.2ms)[0m  SELECT `line_items`.* FROM `line_items` WHERE (`line_items`.cart_id = 1)
  [1m[36mProduct Load (0.3ms)[0m  [1mSELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1[0m
Rendered line_items/_line_item.html.erb (5.0ms)
Rendered carts/_cart.html.erb (9.4ms)
  [1m[35mSQL (0.2ms)[0m  SELECT SUM(`line_items`.`quantity`) AS sum_id FROM `line_items` WHERE (`line_items`.cart_id = 1)
Rendered line_items/create.js.rjs (11.8ms)
Completed 200 OK in 42ms (Views: 26.4ms | ActiveRecord: 3.4ms)
  [1m[36mCart Load (0.2ms)[0m  [1mSELECT `carts`.* FROM `carts` WHERE `carts`.`id` = 1 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  SELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 1)
  [1m[36mLineItem Load (0.2ms)[0m  [1mSELECT `line_items`.* FROM `line_items` WHERE (`line_items`.cart_id = 1)[0m
  [1m[35mProduct Load (0.1ms)[0m  SELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1


Started GET "/orders/new" for 127.0.0.1 at 2011-07-23 13:07:11 +0800
  Processing by OrdersController#new as HTML
  [1m[36mCart Load (0.2ms)[0m  [1mSELECT `carts`.* FROM `carts` WHERE `carts`.`id` = 1 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  SELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 1)
Rendered orders/_form.html.erb (8.1ms)
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 1)[0m
  [1m[35mCACHE (0.0ms)[0m  SELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 1)
  [1m[36mLineItem Load (0.3ms)[0m  [1mSELECT `line_items`.* FROM `line_items` WHERE (`line_items`.cart_id = 1)[0m
  [1m[35mProduct Load (0.2ms)[0m  SELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1
Rendered line_items/_line_item.html.erb (1.5ms)
Rendered carts/_cart.html.erb (4.3ms)
Rendered orders/new.html.erb within layouts/application (15.9ms)
Completed 200 OK in 22ms (Views: 17.4ms | ActiveRecord: 1.6ms)


Started POST "/orders" for 127.0.0.1 at 2011-07-23 13:07:11 +0800
  Processing by OrdersController#create as HTML
  Parameters: {"order"=>{"name"=>"Dave Thomas", "address"=>"123 The Street", "email"=>"cui.shujun@live.cn", "pay_type"=>"Check"}}
  [1m[36mCart Load (0.3ms)[0m  [1mSELECT `carts`.* FROM `carts` WHERE `carts`.`id` = 1 LIMIT 1[0m
  [1m[35mLineItem Load (0.2ms)[0m  SELECT `line_items`.* FROM `line_items` WHERE (`line_items`.cart_id = 1)
  [1m[36mSQL (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.2ms)[0m  describe `orders`
  [1m[36mAREL (0.1ms)[0m  [1mINSERT INTO `orders` (`name`, `address`, `email`, `pay_type`, `created_at`, `updated_at`) VALUES ('Dave Thomas', '123 The Street', 'cui.shujun@live.cn', 'Check', '2011-07-23 05:07:11', '2011-07-23 05:07:11')[0m
  [1m[35mAREL (0.2ms)[0m  UPDATE `line_items` SET `cart_id` = NULL, `order_id` = 1, `updated_at` = '2011-07-23 05:07:11' WHERE `line_items`.`id` = 1
  [1m[36mSQL (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCart Load (0.2ms)[0m  SELECT `carts`.* FROM `carts` WHERE `carts`.`id` = 1 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mLineItem Load (0.1ms)[0m  SELECT `line_items`.* FROM `line_items` WHERE (`line_items`.cart_id = 1)
  [1m[36mAREL (0.1ms)[0m  [1mDELETE FROM `carts` WHERE `carts`.`id` = 1[0m
  [1m[35mSQL (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mProduct Load (0.3ms)[0m  [1mSELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1[0m
Rendered line_items/_line_item.text.erb (1.3ms)
Rendered notifier/order_received.text.erb (2.6ms)

Sent mail to cui.shujun@live.cn (25ms)
Date: Sat, 23 Jul 2011 13:07:12 +0800
From: shujun.cui@cubead.com
To: cui.shujun@live.cn
Message-ID: <4e2a57006556_99b80443b3c8048f@localhost.mail>
Subject: Pragmatic Store Order Confirmation
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

Dear Dave Thomas

Thank you for your recent order from The Pragmatic Store.

You ordered the following items:

 1 x Programming Ruby


We'll send you a separate e-mail when your order ships.
Redirected to http://www.example.com/cn
Completed 302 Found in 111ms


Started GET "/cn" for 127.0.0.1 at 2011-07-23 13:07:12 +0800
  Processing by StoreController#index as HTML
  Parameters: {"locale"=>"cn"}
  [1m[35mProduct Load (0.3ms)[0m  SELECT `products`.* FROM `products` ORDER BY title
  [1m[36mSQL (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mAREL (0.2ms)[0m  INSERT INTO `carts` (`created_at`, `updated_at`) VALUES ('2011-07-23 05:07:12', '2011-07-23 05:07:12')
  [1m[36mSQL (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  SELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 2)
Rendered carts/_cart.html.erb (0.1ms)
Rendered store/index.html.erb within layouts/application (4.1ms)
Completed 200 OK in 7ms (Views: 4.3ms | ActiveRecord: 4.1ms)
  [1m[36mCart Load (0.3ms)[0m  [1mSELECT `carts`.* FROM `carts` WHERE `carts`.`id` = 2 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  SELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 2)
  [1m[36mOrder Load (0.2ms)[0m  [1mSELECT `orders`.* FROM `orders`[0m
  [1m[35mSQL (0.2ms)[0m  SELECT COUNT(*) FROM `line_items` WHERE (`line_items`.order_id = 1)
  [1m[36mLineItem Load (0.2ms)[0m  [1mSELECT `line_items`.* FROM `line_items` WHERE (`line_items`.order_id = 1)[0m
  [1m[35mProduct Load (0.1ms)[0m  SELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mROLLBACK[0m
  [1m[36mSQL (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.3ms)[0m  SELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  SELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  SELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  SELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  SELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35mSQL (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.3ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` IS NULL) LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.4ms)[0m  SHOW TABLES
  [1m[36mProduct Load (0.3ms)[0m  [1mSELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'Programming Ruby') LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35mSQL (0.1ms)[0m  BEGIN
  [1m[36mProduct Load (0.2ms)[0m  [1mSELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1[0m
  [1m[35mSQL (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'Programming Ruby') LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35mSQL (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.3ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'Book') LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mAREL (0.4ms)[0m  DELETE FROM `line_items`
  [1m[36mAREL (0.2ms)[0m  [1mDELETE FROM `orders`[0m
  [1m[35mSQL (0.3ms)[0m  SHOW TABLES
  [1m[36mProduct Load (0.2ms)[0m  [1mSELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1[0m


Started GET "/" for 127.0.0.1 at 2011-07-23 13:09:47 +0800
  Processing by StoreController#index as HTML
  [1m[35mProduct Load (0.3ms)[0m  SELECT `products`.* FROM `products` ORDER BY title
  [1m[36mSQL (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.9ms)[0m  describe `carts`
  [1m[36mAREL (0.2ms)[0m  [1mINSERT INTO `carts` (`created_at`, `updated_at`) VALUES ('2011-07-23 05:09:47', '2011-07-23 05:09:47')[0m
  [1m[35mSQL (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mSELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 1)[0m
Rendered carts/_cart.html.erb (0.5ms)
Rendered store/index.html.erb within layouts/application (107.2ms)
Completed 200 OK in 122ms (Views: 110.1ms | ActiveRecord: 4.7ms)


Started POST "/line_items" for 127.0.0.1 at 2011-07-23 13:09:47 +0800
  Processing by LineItemsController#create as JS
  Parameters: {"product_id"=>"207281424"}
  [1m[35mCart Load (0.2ms)[0m  SELECT `carts`.* FROM `carts` WHERE `carts`.`id` = 1 LIMIT 1
  [1m[36mProduct Load (0.1ms)[0m  [1mSELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1[0m
  [1m[35mLineItem Load (0.2ms)[0m  SELECT `line_items`.* FROM `line_items` WHERE `line_items`.`product_id` = 207281424 AND (`line_items`.cart_id = 1) LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (2.4ms)[0m  describe `line_items`
  [1m[36mAREL (0.2ms)[0m  [1mINSERT INTO `line_items` (`product_id`, `cart_id`, `created_at`, `updated_at`, `quantity`, `order_id`) VALUES (207281424, 1, '2011-07-23 05:09:47', '2011-07-23 05:09:47', 1, NULL)[0m
  [1m[35mSQL (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mSELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 1)[0m
  [1m[35mLineItem Load (0.2ms)[0m  SELECT `line_items`.* FROM `line_items` WHERE (`line_items`.cart_id = 1)
  [1m[36mProduct Load (0.3ms)[0m  [1mSELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1[0m
Rendered line_items/_line_item.html.erb (5.0ms)
Rendered carts/_cart.html.erb (9.4ms)
  [1m[35mSQL (0.2ms)[0m  SELECT SUM(`line_items`.`quantity`) AS sum_id FROM `line_items` WHERE (`line_items`.cart_id = 1)
Rendered line_items/create.js.rjs (11.6ms)
Completed 200 OK in 42ms (Views: 25.4ms | ActiveRecord: 4.2ms)
  [1m[36mCart Load (0.2ms)[0m  [1mSELECT `carts`.* FROM `carts` WHERE `carts`.`id` = 1 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  SELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 1)
  [1m[36mLineItem Load (0.2ms)[0m  [1mSELECT `line_items`.* FROM `line_items` WHERE (`line_items`.cart_id = 1)[0m
  [1m[35mProduct Load (0.2ms)[0m  SELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1


Started GET "/orders/new" for 127.0.0.1 at 2011-07-23 13:09:47 +0800
  Processing by OrdersController#new as HTML
  [1m[36mCart Load (0.2ms)[0m  [1mSELECT `carts`.* FROM `carts` WHERE `carts`.`id` = 1 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  SELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 1)
Rendered orders/_form.html.erb (7.5ms)
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 1)[0m
  [1m[35mCACHE (0.0ms)[0m  SELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 1)
  [1m[36mLineItem Load (0.3ms)[0m  [1mSELECT `line_items`.* FROM `line_items` WHERE (`line_items`.cart_id = 1)[0m
  [1m[35mProduct Load (0.2ms)[0m  SELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1
Rendered line_items/_line_item.html.erb (1.5ms)
Rendered carts/_cart.html.erb (4.4ms)
Rendered orders/new.html.erb within layouts/application (15.2ms)
Completed 200 OK in 20ms (Views: 16.5ms | ActiveRecord: 1.6ms)


Started POST "/orders" for 127.0.0.1 at 2011-07-23 13:09:47 +0800
  Processing by OrdersController#create as HTML
  Parameters: {"order"=>{"name"=>"Dave Thomas", "address"=>"123 The Street", "email"=>"cui.shujun@live.cn", "pay_type"=>"Check"}}
  [1m[36mCart Load (0.3ms)[0m  [1mSELECT `carts`.* FROM `carts` WHERE `carts`.`id` = 1 LIMIT 1[0m
  [1m[35mLineItem Load (0.2ms)[0m  SELECT `line_items`.* FROM `line_items` WHERE (`line_items`.cart_id = 1)
  [1m[36mSQL (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.6ms)[0m  describe `orders`
  [1m[36mAREL (0.1ms)[0m  [1mINSERT INTO `orders` (`name`, `address`, `email`, `pay_type`, `created_at`, `updated_at`) VALUES ('Dave Thomas', '123 The Street', 'cui.shujun@live.cn', 'Check', '2011-07-23 05:09:47', '2011-07-23 05:09:47')[0m
  [1m[35mAREL (0.2ms)[0m  UPDATE `line_items` SET `cart_id` = NULL, `order_id` = 1, `updated_at` = '2011-07-23 05:09:47' WHERE `line_items`.`id` = 1
  [1m[36mSQL (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCart Load (0.1ms)[0m  SELECT `carts`.* FROM `carts` WHERE `carts`.`id` = 1 LIMIT 1
  [1m[36mSQL (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mLineItem Load (0.1ms)[0m  SELECT `line_items`.* FROM `line_items` WHERE (`line_items`.cart_id = 1)
  [1m[36mAREL (0.1ms)[0m  [1mDELETE FROM `carts` WHERE `carts`.`id` = 1[0m
  [1m[35mSQL (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mProduct Load (0.3ms)[0m  [1mSELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1[0m
Rendered line_items/_line_item.text.erb (1.3ms)
Rendered notifier/order_received.text.erb (2.4ms)

Sent mail to cui.shujun@live.cn (26ms)
Date: Sat, 23 Jul 2011 13:09:47 +0800
From: shujun.cui@cubead.com
To: cui.shujun@live.cn
Message-ID: <4e2a579b8c844_9cb80443b3c904c4@localhost.mail>
Subject: Pragmatic Store Order Confirmation
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

Dear Dave Thomas

Thank you for your recent order from The Pragmatic Store.

You ordered the following items:

 1 x Programming Ruby


We'll send you a separate e-mail when your order ships.
Redirected to http://www.example.com/cn
Completed 302 Found in 110ms


Started GET "/cn" for 127.0.0.1 at 2011-07-23 13:09:47 +0800
  Processing by StoreController#index as HTML
  Parameters: {"locale"=>"cn"}
  [1m[35mProduct Load (0.3ms)[0m  SELECT `products`.* FROM `products` ORDER BY title
  [1m[36mSQL (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mAREL (0.2ms)[0m  INSERT INTO `carts` (`created_at`, `updated_at`) VALUES ('2011-07-23 05:09:47', '2011-07-23 05:09:47')
  [1m[36mSQL (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  SELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 2)
Rendered carts/_cart.html.erb (0.0ms)
Rendered store/index.html.erb within layouts/application (4.1ms)
Completed 200 OK in 7ms (Views: 4.2ms | ActiveRecord: 4.3ms)
  [1m[36mCart Load (0.2ms)[0m  [1mSELECT `carts`.* FROM `carts` WHERE `carts`.`id` = 2 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  SELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 2)
  [1m[36mOrder Load (0.2ms)[0m  [1mSELECT `orders`.* FROM `orders`[0m
  [1m[35mSQL (0.2ms)[0m  SELECT COUNT(*) FROM `line_items` WHERE (`line_items`.order_id = 1)
  [1m[36mLineItem Load (0.2ms)[0m  [1mSELECT `line_items`.* FROM `line_items` WHERE (`line_items`.order_id = 1)[0m
  [1m[35mProduct Load (0.2ms)[0m  SELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mROLLBACK[0m
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.0ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.3ms)[0m  SELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  SELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  SELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  SELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  SELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35mSQL (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.3ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` IS NULL) LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.3ms)[0m  SHOW TABLES
  [1m[36mProduct Load (0.2ms)[0m  [1mSELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'Programming Ruby') LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35mSQL (0.0ms)[0m  BEGIN
  [1m[36mProduct Load (0.2ms)[0m  [1mSELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1[0m
  [1m[35mSQL (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'Programming Ruby') LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35mSQL (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.2ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'Book') LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.0ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mAREL (0.2ms)[0m  DELETE FROM `line_items`
  [1m[36mAREL (0.2ms)[0m  [1mDELETE FROM `orders`[0m
  [1m[35mSQL (0.3ms)[0m  SHOW TABLES
  [1m[36mProduct Load (0.3ms)[0m  [1mSELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1[0m


Started GET "/" for 127.0.0.1 at 2011-07-23 14:50:33 +0800
  Processing by StoreController#index as HTML
  [1m[35mProduct Load (0.3ms)[0m  SELECT `products`.* FROM `products` ORDER BY title
  [1m[36mSQL (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  describe `carts`
  [1m[36mAREL (0.2ms)[0m  [1mINSERT INTO `carts` (`created_at`, `updated_at`) VALUES ('2011-07-23 06:50:33', '2011-07-23 06:50:33')[0m
  [1m[35mSQL (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mSELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 1)[0m
Rendered carts/_cart.html.erb (0.6ms)
Rendered store/index.html.erb within layouts/application (110.0ms)
Completed 200 OK in 126ms (Views: 112.4ms | ActiveRecord: 4.4ms)


Started POST "/line_items" for 127.0.0.1 at 2011-07-23 14:50:34 +0800
  Processing by LineItemsController#create as JS
  Parameters: {"product_id"=>"207281424"}
  [1m[35mCart Load (0.3ms)[0m  SELECT `carts`.* FROM `carts` WHERE `carts`.`id` = 1 LIMIT 1
  [1m[36mProduct Load (0.2ms)[0m  [1mSELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1[0m
  [1m[35mLineItem Load (0.2ms)[0m  SELECT `line_items`.* FROM `line_items` WHERE `line_items`.`product_id` = 207281424 AND (`line_items`.cart_id = 1) LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.5ms)[0m  describe `line_items`
  [1m[36mAREL (0.2ms)[0m  [1mINSERT INTO `line_items` (`product_id`, `cart_id`, `created_at`, `updated_at`, `quantity`, `order_id`) VALUES (207281424, 1, '2011-07-23 06:50:34', '2011-07-23 06:50:34', 1, NULL)[0m
  [1m[35mSQL (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mSELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 1)[0m
  [1m[35mLineItem Load (0.2ms)[0m  SELECT `line_items`.* FROM `line_items` WHERE (`line_items`.cart_id = 1)
  [1m[36mProduct Load (0.3ms)[0m  [1mSELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1[0m
Rendered line_items/_line_item.html.erb (5.2ms)
Rendered carts/_cart.html.erb (9.4ms)
  [1m[35mSQL (0.2ms)[0m  SELECT SUM(`line_items`.`quantity`) AS sum_id FROM `line_items` WHERE (`line_items`.cart_id = 1)
Rendered line_items/create.js.rjs (11.8ms)
Completed 200 OK in 43ms (Views: 26.5ms | ActiveRecord: 3.3ms)
  [1m[36mCart Load (0.2ms)[0m  [1mSELECT `carts`.* FROM `carts` WHERE `carts`.`id` = 1 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  SELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 1)
  [1m[36mLineItem Load (0.2ms)[0m  [1mSELECT `line_items`.* FROM `line_items` WHERE (`line_items`.cart_id = 1)[0m
  [1m[35mProduct Load (0.1ms)[0m  SELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1


Started GET "/orders/new" for 127.0.0.1 at 2011-07-23 14:50:34 +0800
  Processing by OrdersController#new as HTML
  [1m[36mCart Load (0.3ms)[0m  [1mSELECT `carts`.* FROM `carts` WHERE `carts`.`id` = 1 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  SELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 1)
Rendered orders/_form.html.erb (8.1ms)
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 1)[0m
  [1m[35mCACHE (0.0ms)[0m  SELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 1)
  [1m[36mLineItem Load (0.3ms)[0m  [1mSELECT `line_items`.* FROM `line_items` WHERE (`line_items`.cart_id = 1)[0m
  [1m[35mProduct Load (0.2ms)[0m  SELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1
Rendered line_items/_line_item.html.erb (1.6ms)
Rendered carts/_cart.html.erb (4.4ms)
Rendered orders/new.html.erb within layouts/application (16.0ms)
Completed 200 OK in 22ms (Views: 17.3ms | ActiveRecord: 1.8ms)


Started POST "/orders" for 127.0.0.1 at 2011-07-23 14:50:34 +0800
  Processing by OrdersController#create as HTML
  Parameters: {"order"=>{"name"=>"Dave Thomas", "address"=>"123 The Street", "email"=>"cui.shujun@live.cn", "pay_type"=>"Check"}}
  [1m[36mCart Load (0.5ms)[0m  [1mSELECT `carts`.* FROM `carts` WHERE `carts`.`id` = 1 LIMIT 1[0m
  [1m[35mLineItem Load (0.3ms)[0m  SELECT `line_items`.* FROM `line_items` WHERE (`line_items`.cart_id = 1)
  [1m[36mSQL (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.4ms)[0m  describe `orders`
  [1m[36mAREL (0.1ms)[0m  [1mINSERT INTO `orders` (`name`, `address`, `email`, `pay_type`, `created_at`, `updated_at`) VALUES ('Dave Thomas', '123 The Street', 'cui.shujun@live.cn', 'Check', '2011-07-23 06:50:34', '2011-07-23 06:50:34')[0m
  [1m[35mAREL (0.2ms)[0m  UPDATE `line_items` SET `cart_id` = NULL, `order_id` = 1, `updated_at` = '2011-07-23 06:50:34' WHERE `line_items`.`id` = 1
  [1m[36mSQL (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCart Load (0.1ms)[0m  SELECT `carts`.* FROM `carts` WHERE `carts`.`id` = 1 LIMIT 1
  [1m[36mSQL (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mLineItem Load (0.1ms)[0m  SELECT `line_items`.* FROM `line_items` WHERE (`line_items`.cart_id = 1)
  [1m[36mAREL (0.1ms)[0m  [1mDELETE FROM `carts` WHERE `carts`.`id` = 1[0m
  [1m[35mSQL (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mProduct Load (0.3ms)[0m  [1mSELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1[0m
Rendered line_items/_line_item.text.erb (1.4ms)
Rendered notifier/order_received.text.erb (2.9ms)

Sent mail to cui.shujun@live.cn (26ms)
Date: Sat, 23 Jul 2011 14:50:34 +0800
From: shujun.cui@cubead.com
To: cui.shujun@live.cn
Message-ID: <4e2a6f3a37b24_ae880443b3c558@localhost.mail>
Subject: Pragmatic Store Order Confirmation
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

Dear Dave Thomas

Thank you for your recent order from The Pragmatic Store.

You ordered the following items:

 1 x Programming Ruby


We'll send you a separate e-mail when your order ships.
Redirected to http://www.example.com/cn
Completed 302 Found in 113ms


Started GET "/cn" for 127.0.0.1 at 2011-07-23 14:50:34 +0800
  Processing by StoreController#index as HTML
  Parameters: {"locale"=>"cn"}
  [1m[35mProduct Load (0.3ms)[0m  SELECT `products`.* FROM `products` ORDER BY title
  [1m[36mSQL (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mAREL (0.2ms)[0m  INSERT INTO `carts` (`created_at`, `updated_at`) VALUES ('2011-07-23 06:50:34', '2011-07-23 06:50:34')
  [1m[36mSQL (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  SELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 2)
Rendered carts/_cart.html.erb (0.1ms)
Rendered store/index.html.erb within layouts/application (3.8ms)
Completed 200 OK in 7ms (Views: 4.0ms | ActiveRecord: 4.5ms)
  [1m[36mCart Load (0.2ms)[0m  [1mSELECT `carts`.* FROM `carts` WHERE `carts`.`id` = 2 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  SELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 2)
  [1m[36mOrder Load (0.2ms)[0m  [1mSELECT `orders`.* FROM `orders`[0m
  [1m[35mSQL (0.1ms)[0m  SELECT COUNT(*) FROM `line_items` WHERE (`line_items`.order_id = 1)
  [1m[36mLineItem Load (0.1ms)[0m  [1mSELECT `line_items`.* FROM `line_items` WHERE (`line_items`.order_id = 1)[0m
  [1m[35mProduct Load (0.1ms)[0m  SELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mROLLBACK[0m
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.0ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.3ms)[0m  SELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  SELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  SELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  SELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  SELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'My book title') LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35mSQL (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.2ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` IS NULL) LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.3ms)[0m  SHOW TABLES
  [1m[36mProduct Load (0.3ms)[0m  [1mSELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'Programming Ruby') LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35mSQL (0.1ms)[0m  BEGIN
  [1m[36mProduct Load (0.2ms)[0m  [1mSELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'Programming Ruby') LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35mSQL (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.3ms)[0m  [1mSELECT 1 FROM `products` WHERE (`products`.`title` = BINARY 'Book') LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.0ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.1ms)[0m  ROLLBACK
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mAREL (0.2ms)[0m  DELETE FROM `line_items`
  [1m[36mAREL (0.2ms)[0m  [1mDELETE FROM `orders`[0m
  [1m[35mSQL (0.3ms)[0m  SHOW TABLES
  [1m[36mProduct Load (0.2ms)[0m  [1mSELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1[0m


Started GET "/" for 127.0.0.1 at 2011-07-23 14:51:08 +0800
  Processing by StoreController#index as HTML
  [1m[35mProduct Load (0.3ms)[0m  SELECT `products`.* FROM `products` ORDER BY title
  [1m[36mSQL (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.1ms)[0m  describe `carts`
  [1m[36mAREL (0.2ms)[0m  [1mINSERT INTO `carts` (`created_at`, `updated_at`) VALUES ('2011-07-23 06:51:08', '2011-07-23 06:51:08')[0m
  [1m[35mSQL (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mSELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 1)[0m
Rendered carts/_cart.html.erb (0.6ms)
Rendered store/index.html.erb within layouts/application (116.2ms)
Completed 200 OK in 133ms (Views: 118.6ms | ActiveRecord: 4.5ms)


Started POST "/line_items" for 127.0.0.1 at 2011-07-23 14:51:08 +0800
  Processing by LineItemsController#create as JS
  Parameters: {"product_id"=>"207281424"}
  [1m[35mCart Load (0.3ms)[0m  SELECT `carts`.* FROM `carts` WHERE `carts`.`id` = 1 LIMIT 1
  [1m[36mProduct Load (0.2ms)[0m  [1mSELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1[0m
  [1m[35mLineItem Load (0.2ms)[0m  SELECT `line_items`.* FROM `line_items` WHERE `line_items`.`product_id` = 207281424 AND (`line_items`.cart_id = 1) LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.3ms)[0m  describe `line_items`
  [1m[36mAREL (0.1ms)[0m  [1mINSERT INTO `line_items` (`product_id`, `cart_id`, `created_at`, `updated_at`, `quantity`, `order_id`) VALUES (207281424, 1, '2011-07-23 06:51:08', '2011-07-23 06:51:08', 1, NULL)[0m
  [1m[35mSQL (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mSELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 1)[0m
  [1m[35mLineItem Load (0.2ms)[0m  SELECT `line_items`.* FROM `line_items` WHERE (`line_items`.cart_id = 1)
  [1m[36mProduct Load (0.3ms)[0m  [1mSELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1[0m
Rendered line_items/_line_item.html.erb (4.8ms)
Rendered carts/_cart.html.erb (9.0ms)
  [1m[35mSQL (0.2ms)[0m  SELECT SUM(`line_items`.`quantity`) AS sum_id FROM `line_items` WHERE (`line_items`.cart_id = 1)
Rendered line_items/create.js.rjs (11.4ms)
Completed 200 OK in 42ms (Views: 25.7ms | ActiveRecord: 3.3ms)
  [1m[36mCart Load (0.2ms)[0m  [1mSELECT `carts`.* FROM `carts` WHERE `carts`.`id` = 1 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  SELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 1)
  [1m[36mLineItem Load (0.2ms)[0m  [1mSELECT `line_items`.* FROM `line_items` WHERE (`line_items`.cart_id = 1)[0m
  [1m[35mProduct Load (0.2ms)[0m  SELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1


Started GET "/orders/new" for 127.0.0.1 at 2011-07-23 14:51:08 +0800
  Processing by OrdersController#new as HTML
  [1m[36mCart Load (0.2ms)[0m  [1mSELECT `carts`.* FROM `carts` WHERE `carts`.`id` = 1 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  SELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 1)
Rendered orders/_form.html.erb (9.4ms)
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 1)[0m
  [1m[35mCACHE (0.0ms)[0m  SELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 1)
  [1m[36mLineItem Load (0.2ms)[0m  [1mSELECT `line_items`.* FROM `line_items` WHERE (`line_items`.cart_id = 1)[0m
  [1m[35mProduct Load (0.2ms)[0m  SELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1
Rendered line_items/_line_item.html.erb (1.9ms)
Rendered carts/_cart.html.erb (5.4ms)
Rendered orders/new.html.erb within layouts/application (18.9ms)
Completed 200 OK in 26ms (Views: 20.7ms | ActiveRecord: 1.5ms)


Started POST "/orders" for 127.0.0.1 at 2011-07-23 14:51:08 +0800
  Processing by OrdersController#create as HTML
  Parameters: {"order"=>{"name"=>"Dave Thomas", "address"=>"123 The Street", "email"=>"cui.shujun@live.cn", "pay_type"=>"Check"}}
  [1m[36mCart Load (0.2ms)[0m  [1mSELECT `carts`.* FROM `carts` WHERE `carts`.`id` = 1 LIMIT 1[0m
  [1m[35mLineItem Load (0.2ms)[0m  SELECT `line_items`.* FROM `line_items` WHERE (`line_items`.cart_id = 1)
  [1m[36mSQL (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (2.2ms)[0m  describe `orders`
  [1m[36mAREL (0.2ms)[0m  [1mINSERT INTO `orders` (`name`, `address`, `email`, `pay_type`, `created_at`, `updated_at`) VALUES ('Dave Thomas', '123 The Street', 'cui.shujun@live.cn', 'Check', '2011-07-23 06:51:08', '2011-07-23 06:51:08')[0m
  [1m[35mAREL (0.3ms)[0m  UPDATE `line_items` SET `cart_id` = NULL, `order_id` = 1, `updated_at` = '2011-07-23 06:51:08' WHERE `line_items`.`id` = 1
  [1m[36mSQL (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mCart Load (0.3ms)[0m  SELECT `carts`.* FROM `carts` WHERE `carts`.`id` = 1 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mLineItem Load (0.2ms)[0m  SELECT `line_items`.* FROM `line_items` WHERE (`line_items`.cart_id = 1)
  [1m[36mAREL (0.2ms)[0m  [1mDELETE FROM `carts` WHERE `carts`.`id` = 1[0m
  [1m[35mSQL (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mProduct Load (0.3ms)[0m  [1mSELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1[0m
Rendered line_items/_line_item.text.erb (1.3ms)
Rendered notifier/order_received.text.erb (2.4ms)

Sent mail to cui.shujun@live.cn (26ms)
Date: Sat, 23 Jul 2011 14:51:09 +0800
From: shujun.cui@cubead.com
To: cui.shujun@live.cn
Message-ID: <4e2a6f5dea0a_b3580443b3c2838f@localhost.mail>
Subject: Pragmatic Store Order Confirmation
Mime-Version: 1.0
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

Dear Dave Thomas

Thank you for your recent order from The Pragmatic Store.

You ordered the following items:

 1 x Programming Ruby


We'll send you a separate e-mail when your order ships.
Redirected to http://www.example.com/cn
Completed 302 Found in 230ms


Started GET "/cn" for 127.0.0.1 at 2011-07-23 14:51:09 +0800
  Processing by StoreController#index as HTML
  Parameters: {"locale"=>"cn"}
  [1m[35mProduct Load (0.3ms)[0m  SELECT `products`.* FROM `products` ORDER BY title
  [1m[36mSQL (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mAREL (0.2ms)[0m  INSERT INTO `carts` (`created_at`, `updated_at`) VALUES ('2011-07-23 06:51:09', '2011-07-23 06:51:09')
  [1m[36mSQL (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  SELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 2)
Rendered carts/_cart.html.erb (0.0ms)
Rendered store/index.html.erb within layouts/application (3.9ms)
Completed 200 OK in 7ms (Views: 4.1ms | ActiveRecord: 5.8ms)
  [1m[36mCart Load (0.2ms)[0m  [1mSELECT `carts`.* FROM `carts` WHERE `carts`.`id` = 2 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  SELECT COUNT(*) FROM `line_items` WHERE (`line_items`.cart_id = 2)
  [1m[36mOrder Load (0.2ms)[0m  [1mSELECT `orders`.* FROM `orders`[0m
  [1m[35mSQL (0.1ms)[0m  SELECT COUNT(*) FROM `line_items` WHERE (`line_items`.order_id = 1)
  [1m[36mLineItem Load (0.2ms)[0m  [1mSELECT `line_items`.* FROM `line_items` WHERE (`line_items`.order_id = 1)[0m
  [1m[35mProduct Load (0.2ms)[0m  SELECT `products`.* FROM `products` WHERE `products`.`id` = 207281424 ORDER BY title LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mROLLBACK[0m
